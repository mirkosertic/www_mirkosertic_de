<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Nullpointer-free Java: Combining AOP with Modern Validation Standards &middot; Mirko Sertic</title><meta name="description" content="Stop fighting those pesky NullPointerExceptions with repetitive checks throughout your code! By combining the power of Aspect-Oriented Programming with JSR-303 validation standards, Java applications can become more robust while maintaining clean, DRY code that handles null checks elegantly."><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="robots" content="index,follow"><meta property="og:title" content="Nullpointer-free Java: Combining AOP with Modern Validation Standards"><meta property="og:description" content="Stop fighting those pesky NullPointerExceptions with repetitive checks throughout your code! By combining the power of Aspect-Oriented Programming with JSR-303 validation standards, Java applications can become more robust while maintaining clean, DRY code that handles null checks elegantly."><meta property="og:type" content="article"><meta property="og:url" content="https://www.mirkosertic.de/blog/2012/07/software-defect-detection-with-aop-and-jsr-303-jsr-305-jsr-308/"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="https://www.mirkosertic.de/css/site.css" rel="stylesheet" media="screen"><link rel="shortcut icon" type="image/x-icon" href="https://www.mirkosertic.de/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://www.mirkosertic.de/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://www.mirkosertic.de/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://www.mirkosertic.de/favicon-16x16.png"><link rel="manifest" href="https://www.mirkosertic.de/manifest.json"><link rel="mask-icon" href="https://www.mirkosertic.de/safari-pinned-tab.svg" color="#5bbad5"><meta name="theme-color" content="#ffffff"><script>var _paq = window._paq = window._paq || [];
         
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="//analytics.mirkosertic.de/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '2']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();</script></head><body itemscope itemtype="http://schema.org/WebPage"><header><nav class="navbar navbar-expand-md navbar-dark fixed-top" itemscope itemtype="http://www.schema.org/SiteNavigationElement"><div class="container"><a class="navbar-brand" href="https://www.mirkosertic.de/">www.mirkosertic.de</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav mr-auto"><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/toolsgoodies" title="My personal Technology Radar">Technology Radar</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/interestingbooks" title="Interesting Books">Essential Books</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/favorites" title="My favorite postings">My favorite postings</a></li><li class="nav-item"><a itemprop="url" class="nav-link active" href="/post/" title="Blog">Blog</a></li></ul></div></div></nav></header><main role="main"><div itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><div class="contentbox"><h1 class="post-title" itemprop="name headline">Nullpointer-free Java: Combining AOP with Modern Validation Standards</h1><p class="post-date"><span class="icon"><i class="fa fa-calendar-check-o-white"></i></span><time datetime="2012-07-30" itemprop="datePublished">Mon, Jul 30, 2012</time> <span>by</span> <span itemprop="author" itemscope="" itemtype="https://schema.org/Person"><span itemprop="name"><a href="https://x.com/mirkosertic" rel="author">Mirko Sertic</a></span></span></p><p class="post-abstract" itemprop="abstract"><span>This article explores modern approaches to prevent common runtime exceptions in Java applications, particularly focusing on NullPointerExceptions. It demonstrates how combining Aspect-Oriented Programming (AOP) with validation standards like JSR-303, JSR-305, and JSR-308 can lead to more robust and maintainable code. The article compares different validation approaches, shows practical examples of annotation-based validation, and explains how AOP can be used to implement validation checks without violating the DRY principle. Special attention is given to method-level validation and the benefits of using these techniques in real-world applications.</span></p><p><span class="icon"><i class="fa fa-clock-white"></i></span><span>3 Minutes reading time</span></p><p class="post-tags"><span class="tag"><span class="icon"><i class="fa fa-tags-white"></i></span><a href="/tags/aop">AOP</a> ,<a href="/tags/interesting">Interesting</a></span></p></div></header><figure class="blogtitleimage"><figcaption><p>Behold the masterpiece that AI hallucinated while reading this post:</p><p class="title">"Little Java&#39;s Great Adventure: How to Make Null Monsters Go Away"</p><p>(after I fed it way too many marketing blogs and memes)</p><p class="aidisclosure">Created using DALL-E 3</p></figcaption><img src="/media/welcomeimages/software-defect-detection-with-aop-and-jsr-303-jsr-305-jsr-308_selected.png" alt="AI-Generated: Little Java&#39;s Great Adventure: How to Make Null Monsters Go Away" itemprop="image"></figure><article class="post-content clearfix" itemprop="articleBody"><div class="sect1"><h2 id="_summary">Summary</h2><div class="sectionbody"><div class="paragraph"><p>For many years common runtime exceptions like NullPointerException or ClassCastException are haunting poor Java programmers. This often leads to repetitions in the source code for checking method arguments for nullness. This is violating the DRY(Don’t repeat yourself) principle. The Java Community Process created JSR-305 to address this issue. Unfortunately this JSR didn’t become part of the official Java languages, but tools like FindBugs or IDEs like IntelliJ are offering static code analysis to find such NullPointerExceptions at compile time.</p></div><div class="paragraph"><p>Here is an example of a very leaky code:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">public void doSomethingTheOldWay(String aParam) {
	if (aParam == null) {
		throw new IllegalArgumentException();
	}
	int length = aParam.length();
}</code></pre></div></div><div class="paragraph"><p>This method will definitely throw a IllegalArgumentException if null is passed as an argument. Ok, now lets take a look at the following code:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">public String returnSomething() {
        return null;
}

public void compute() {
        int theLength = returnSomething().length();
}</code></pre></div></div><div class="paragraph"><p>This will for sure generate a NullPointerException. Those errors are hard to track. Even with static code analysis FindBugs or IntelliJ do not recognize the problem.</p></div></div></div><div class="sect1"><h2 id="_jsr_305">JSR-305</h2><div class="sectionbody"><div class="paragraph"><p><a href="http://jcp.org/en/jsr/detail?id=305">JSR-305</a> was designed to help with automatic detect detection. This JSR provides a set of common annotations to easy code analysis. Here is an example:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">public void doSomethingWithParam(@Nonnull String aParam) {
        if (aParam == null) {
            throw new IllegalArgumentException();
        }
}

@Nonnull public String compute(@Nonnull String aParam) {
        return null;
}</code></pre></div></div><div class="paragraph"><p>The doSomethingWithParam() Method is annotated so it cannot accept a null as a parameter. The compute() Method is annotated that is does not accept a null parameter and even does not return a null value. Let&#39;&#39;s see what IntellJ inspections are doing with the following example:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">doSomethingWithParam(null);
compute(&#34;Mirko&#34;);</code></pre></div></div><div class="paragraph"><p>This will give you the following bug report:</p></div><div class="paragraph"><p><span class="image"><img src="/media/jsr305.png" alt="jsr305"></span></p></div></div></div><div class="sect1"><h2 id="_jsr_308">JSR-308</h2><div class="sectionbody"><div class="paragraph"><p><a href="http://jcp.org/en/jsr/detail?id=308">JSR-308</a> Annotations on Java Types is another approach to the problem mentioned above. It defines a language extension that will probably be added in Java 8. It includes a set of annotations like @NonNull, @Nullable and so on, and a checker framework as well. Unfortunately it provides some redundant annotations to JSR-303, hopefully this will be fixed.</p></div></div></div><div class="sect1"><h2 id="_jsr_303">JSR-303</h2><div class="sectionbody"><div class="paragraph"><p><a href="http://jcp.org/en/jsr/detail?id=303">JSR-303</a> Bean Validation API gives us the same set of annotations as JSR-305, Nullable, NotNull and so on. It also provides more like validations rules with patterns. JSR-305 was probably retired as JSR-303 or JSR-308 can do the same thing.</p></div><div class="paragraph"><p>Very interesting is JSR-303 Version 1.1. It provides a new Method Level Validation. Details can be found here. The official release is planned for Q3/Q4 2012. IntelliJ does recognize Nullable or NotNull annotations, but not the NotNull annotations for method return value. Here is a bug report generated by IntelliJ for the above example with JSR-303 annotations:</p></div><div class="paragraph"><p><span class="image"><img src="/media/jsr303.png" alt="jsr303"></span></p></div></div></div><div class="sect1"><h2 id="_aop">AOP</h2><div class="sectionbody"><div class="paragraph"><p>Checking method parameters for nullness and manual throwing of IllegalArgumentException is bloating the source code and also violating the DRY principle. We can use an around advice together with an AOP framework like <a href="http://www.eclipse.org/aspectj/">AspectJ</a> to weave every JSR-303 annotated method and decorate it with JSR-303 method level validation. By this way we can check pre- and post conditions of method invocation.</p></div><div class="paragraph"><p>The following code will remain:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">public void doSomethingWithParam(@NotNull String aParam) {
        int length = aParam.length();
}</code></pre></div></div><div class="paragraph"><p>In this case, the IllegalArgumentException is thrown by the AOP advice. Nice, isn’t it?</p></div></div></div><div class="sect1"><h2 id="_summary_2">Summary</h2><div class="sectionbody"><div class="paragraph"><p>Together with AOP and JSR-303, defect detection automation can be very powerful. It cleans up the sources and also helps not to violate the DRY principle. Feel free to consult the AspectJ documentation or the JSR-303 reference implementation <a href="http://www.hibernate.org/subprojects/validator.html">Hibernate Validator</a> for more information.</p></div></div></div><div class="metainfo"><span>&lt;&lt;Pevious posting: <a href="https://www.mirkosertic.de/blog/2012/07/domain-driven-design-overview-and-building-blocks/">Domain-driven Design Demystified: Essential Building Blocks and Patterns</a></span> <span>Next posting: <a href="https://www.mirkosertic.de/blog/2012/07/enterprise-search-with-apache-solr/">Building a Enterprise Search Engine in One Day with Apache Solr</a>&gt;&gt;</span></div><p><i class="fa fa-github"></i>Git revision: <a href="https://github.com/mirkosertic/www_mirkosertic_de/commit/2e692ad1fff282e93d9fa3fdd726190d7e7afd82" target="_blank">2e692ad</a></p></article></div></main><footer><p>&copy; Mirko Sertic &middot; <a href="https://www.mirkosertic.de/global/impressum/index.html">Imprint / Impressum</a></p><address><strong itemprop="name">Mirko Sertic</strong><div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress"><div itemprop="streetAddress">Josefine-Mauser-Str. 66</div><div itemprop="postalCode">48157 Münster</div><div itemprop="addressCountry">Germany</div></div><a class="icon" target="_top" href="mailto:mirko@mirkosertic.de"><i class="fa fa-envelope-white"></i></a> <a class="icon" target="_blank" href="https://x.com/mirkosertic" itemprop="url"><i class="fa fa-x-twitter-white"></i></a> <a class="icon" target="_blank" href="https://github.com/mirkosertic" itemprop="url"><i class="fa fa-github-white"></i></a> <a class="icon" target="_blank" href="https://de.linkedin.com/in/mirko-sertic-98882397" itemprop="url"><i class="fa fa-linkedin-white"></i></a></address><p class="float-right"><a href="#">Back to top</a></p></footer><script src="https://www.mirkosertic.de/js/bootstrap-native-v4.min.js"></script><script>function existsByCSSSelector(aSelector) {
        var element = document.querySelector(aSelector);
        if (element) {
            return true;
        }
        return false;
    }

    var Loader = function () { };
    Loader.prototype = {
        require: function (scripts, callback) {
            this.loadCount = 0;
            this.totalRequired = scripts.length;
            this.callback = callback;

            for (var i=0;i<scripts.length;i++) {
                this.writeScript(scripts[i]);
            }
        },
        loaded: function (evt) {
            this.loadCount++;

            if (this.loadCount==this.totalRequired && typeof this.callback=='function') this.callback.call();
        },
        writeScript: function (src) {
            var self = this;
            var s = document.createElement('script');
            s.type = "text/javascript";
            s.async = true;
            s.src = src;
            s.addEventListener('load', function (e) { self.loaded(e); }, false);
            var head = document.getElementsByTagName('head')[0];
            head.appendChild(s);
        }
    };

    if (existsByCSSSelector("pre.highlight code") > 0) {
        var loader = new Loader();
        loader.require(["https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"], function() {

            var additionalStylesheet = document.createElement('link');
            additionalStylesheet.rel = "stylesheet";
            additionalStylesheet.type = 'text/css';
            additionalStylesheet.media = "screen";
            additionalStylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";

            var head = document.getElementsByTagName('head')[0];
            head.appendChild(additionalStylesheet);

            hljs.highlightAll();
        });
    }</script></body></html>