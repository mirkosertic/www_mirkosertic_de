<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Modernizing Legacy Apps: Adding CDI Magic to Swing Applications &middot; Mirko Sertic</title><meta name="description" content="Transform your aging Swing applications into modern marvels by adding CDI superpowers with just a few lines of code! This clever hack shows how to bridge the gap between legacy UI frameworks and contemporary dependency injection, making maintenance a breeze and testing a joy."><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="robots" content="index,follow"><meta property="og:title" content="Modernizing Legacy Apps: Adding CDI Magic to Swing Applications"><meta property="og:description" content="Transform your aging Swing applications into modern marvels by adding CDI superpowers with just a few lines of code! This clever hack shows how to bridge the gap between legacy UI frameworks and contemporary dependency injection, making maintenance a breeze and testing a joy."><meta property="og:type" content="article"><meta property="og:url" content="https://www.mirkosertic.de/blog/2012/08/enriching-legacy-applications-with-cdi/"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="https://www.mirkosertic.de/css/site.css" rel="stylesheet" media="screen"><link rel="shortcut icon" type="image/x-icon" href="https://www.mirkosertic.de/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://www.mirkosertic.de/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://www.mirkosertic.de/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://www.mirkosertic.de/favicon-16x16.png"><link rel="manifest" href="https://www.mirkosertic.de/manifest.json"><link rel="mask-icon" href="https://www.mirkosertic.de/safari-pinned-tab.svg" color="#5bbad5"><meta name="theme-color" content="#ffffff"></head><body itemscope itemtype="http://schema.org/WebPage"><header><nav class="navbar navbar-expand-md navbar-dark fixed-top" itemscope itemtype="http://www.schema.org/SiteNavigationElement"><div class="container"><a class="navbar-brand" href="https://www.mirkosertic.de/">www.mirkosertic.de</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav mr-auto"><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/toolsgoodies" title="Tools &amp; Goodies">Tools &amp; Goodies</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/interestingbooks" title="Interesting Books">Interesting Books</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/favorites" title="My favorite postings">My favorite postings</a></li><li class="nav-item"><a itemprop="url" class="nav-link active" href="/post/" title="Blog">Blog</a></li></ul></div></div></nav></header><main role="main"><div itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><div class="contentbox"><h1 class="post-title" itemprop="name headline">Modernizing Legacy Apps: Adding CDI Magic to Swing Applications</h1><p class="post-date"><span class="icon"><i class="fa fa-calendar-check-o-white"></i></span><time datetime="2012-08-15" itemprop="datePublished">Wed, Aug 15, 2012</time> <span>by</span> <span itemprop="author" itemscope="" itemtype="https://schema.org/Person"><span itemprop="name"><a href="https://twitter.com/mirkosertic" itemprop="url" rel="author">Mirko Sertic</a></span></span></p><p class="post-abstract" itemprop="abstract"><span>This technical guide demonstrates how to enhance legacy Java applications by incorporating CDI (Contexts and Dependency Injection) into existing Swing applications. By introducing a custom CDIHelper class and leveraging Weld&#39;s capabilities, developers can modernize their legacy codebase with dependency injection patterns, improving maintainability and testability without complete reengineering. The article provides practical code examples showing how to seamlessly integrate CDI with Swing components, enabling features like interceptors and proper lifecycle management in traditional desktop applications.</span></p><p><span class="icon"><i class="fa fa-clock-white"></i></span><span>3 Minutes reading time</span></p><p class="post-tags"><span class="tag"><span class="icon"><i class="fa fa-tags-white"></i></span><a href="/tags/dependency-injection">Dependency Injection</a> ,<a href="/tags/enterprise">Enterprise</a> ,<a href="/tags/legacy">Legacy</a> ,<a href="/tags/modernization">Modernization</a></span></p></div></header><article class="post-content clearfix" itemprop="articleBody"><div class="paragraph"><p>There are a lot of applications out there. Some of them are legacy, others are in their maintenance phase. While we are developing new applications, we can use the coolest new technologies, think about good design and other stuff. But what about the software maintenance phase? Often, due to lack of time and other constraints, we cannot do everything perfectly, we need to move some refactoring or even re-engineering to the maintenance phase.</p></div><div class="paragraph"><p>While doing software maintenance, i have often seen some very strange object state management mechanisms. And i often thought: man, using CDI would make this pretty simple, why do it so hard? Wouldn’t it be cool do combine Swing or SWT for instance with CDI?</p></div><div class="paragraph"><p>Using CDI(more dependency than context injection) can greatly increase software quality and test-ability. There are a lot of books written about this topic and also Martin Fowler promotes dependency injection. But how can we embed CDI into a legacy application?</p></div><div class="ulist"><ul><li><p>First of all, think twice. It is really worth the pain? If you still feel good about it, go to the next step.</p></li><li><p>Check, which objects could be managed by a container. DAOs or stateless Services are candidates for managed beans.</p></li><li><p>Finally, where are the joint points? Where is the place to combine un-managed objects and managed objects?</p></li></ul></div><div class="paragraph"><p>The key of all is object life-cycle management. You need to be able to handle life-cycle management from your application code to the CDI container. If you can’t do this, stop.</p></div><div class="paragraph"><p>Check the joint points. Classic candidates are UI components. For instance a JFrame somehow needs to know a business service, sometimes a DAO or a transaction manager. The tricky part is how can we mix Swing with CDI? I wrote a small helper class for this:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">import org.jboss.weld.environment.se.Weld;
import org.jboss.weld.environment.se.WeldContainer;

import javax.enterprise.context.spi.CreationalContext;
import javax.enterprise.inject.spi.AnnotatedType;
import javax.enterprise.inject.spi.BeanManager;
import javax.enterprise.inject.spi.InjectionTarget;

public class CDIHelper {

    private static CDIHelper HELPER = new CDIHelper();

    public static CDIHelper instance() {
        return HELPER;
    }

    private Weld weld;
    private WeldContainer weldContainer;

    private CDIHelper() {
        weld = new Weld();
        weldContainer = weld.initialize();
    }

    public &lt;T&gt; T lookup(Class&lt;T&gt; aClazz) {
        return weldContainer.instance().select(aClazz).get();
    }

    public void injectAndConstruct(Object aInstance) {

        BeanManager theManager = weldContainer.getBeanManager();

        AnnotatedType&lt;Object&gt; theType = (AnnotatedType&lt;Object&gt;) theManager.createAnnotatedType(aInstance.getClass());
        InjectionTarget&lt;Object&gt; theTarget = theManager.createInjectionTarget(theType);

        CreationalContext&lt;Object&gt; cc = theManager.createCreationalContext(null);

        theTarget.inject(aInstance, cc);
        theTarget.postConstruct(aInstance);
    }
}</code></pre></div></div><div class="paragraph"><p>Now, let’s create a JFrame and do some dependency injection:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">import javax.annotation.PostConstruct;
import javax.inject.Inject;
import javax.swing.JFrame;
import javax.swing.WindowConstants;

public class JFrameTest extends JFrame {

    @Inject
    Aggregator aggregator;

    public JFrameTest() {
        setSize(320,200);
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    }

    @PostConstruct
    public void init() {
        setTitle(&#34;I got &#34;+aggregator+&#34; from CDI!&#34;);
    }

    public static void main(String[] args) {

        // Init CDI Helper
        CDIHelper theHelper = CDIHelper.instance();

        // Inject dependencies and invoke PostConstruct
        JFrameTest theTest = new JFrameTest();
        theHelper.injectAndConstruct(theTest);

        // Show our frame
        theTest.setVisible(true);
    }
}</code></pre></div></div><div class="paragraph"><p>Quite easy! We can now combine our Swing code with CDI and all of it’s features like Interceptors and so on. Great improvement!</p></div><div class="metainfo"><span>&lt;&lt;Pevious posting: <a href="https://www.mirkosertic.de/blog/2012/08/putting-your-objects-into-context-or-why-overwriting-tostring-can-be-evil/">The Hidden Dangers of toString(): Keeping Business and UI Logic Separate</a></span> <span>Next posting: <a href="https://www.mirkosertic.de/blog/2012/09/the-onion-architecture/">Layered Software Architecture: From Traditional to Onion Pattern</a>&gt;&gt;</span></div><p><i class="fa fa-github"></i>Git revision: <a href="https://github.com/mirkosertic/www_mirkosertic_de/commit/c80594730cca2933f4a385caf46fddef187449d3" target="_blank">c805947</a></p></article></div></main><footer><p>&copy; Mirko Sertic &middot; <a href="https://www.mirkosertic.de/global/impressum/index.html">Imprint / Impressum</a></p><address><strong itemprop="name">Mirko Sertic</strong><div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress"><div itemprop="streetAddress">Josefine-Mauser-Str. 66</div><div itemprop="postalCode">48157 Münster</div><div itemprop="addressCountry">Germany</div></div><a class="icon" target="_top" href="mailto:mirko@mirkosertic.de"><i class="fa fa-envelope-white"></i></a> <a class="icon" target="_blank" href="https://x.com/mirkosertic" itemprop="url"><i class="fa fa-x-twitter-white"></i></a> <a class="icon" target="_blank" href="https://github.com/mirkosertic" itemprop="url"><i class="fa fa-github-white"></i></a> <a class="icon" target="_blank" href="https://de.linkedin.com/in/mirko-sertic-98882397" itemprop="url"><i class="fa fa-linkedin-white"></i></a></address><p class="float-right"><a href="#">Back to top</a></p></footer><script src="https://www.mirkosertic.de/js/bootstrap-native-v4.min.js"></script><script>function existsByCSSSelector(aSelector) {
        var element = document.querySelector(aSelector);
        if (element) {
            return true;
        }
        return false;
    }

    var Loader = function () { };
    Loader.prototype = {
        require: function (scripts, callback) {
            this.loadCount = 0;
            this.totalRequired = scripts.length;
            this.callback = callback;

            for (var i=0;i<scripts.length;i++) {
                this.writeScript(scripts[i]);
            }
        },
        loaded: function (evt) {
            this.loadCount++;

            if (this.loadCount==this.totalRequired && typeof this.callback=='function') this.callback.call();
        },
        writeScript: function (src) {
            var self = this;
            var s = document.createElement('script');
            s.type = "text/javascript";
            s.async = true;
            s.src = src;
            s.addEventListener('load', function (e) { self.loaded(e); }, false);
            var head = document.getElementsByTagName('head')[0];
            head.appendChild(s);
        }
    };

    if (existsByCSSSelector("pre.highlight code") > 0) {
        var loader = new Loader();
        loader.require(["https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"], function() {

            var additionalStylesheet = document.createElement('link');
            additionalStylesheet.rel = "stylesheet";
            additionalStylesheet.type = 'text/css';
            additionalStylesheet.media = "screen";
            additionalStylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";

            var head = document.getElementsByTagName('head')[0];
            head.appendChild(additionalStylesheet);

            hljs.highlightAll();
        });
    }</script></body></html>