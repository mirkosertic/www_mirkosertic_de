<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Beyond Code Coverage: Supercharging Your Tests with Mutation Testing &middot; Mirko Sertic</title><meta name="description" content="Ever wondered if your 80% test coverage actually means anything? Discover how mutation testing introduces deliberate bugs to measure your tests&#39; true effectiveness, turning your test suite from a paper tiger into a real watchdog! PITest makes this powerful technique accessible to Java developers with just a few lines of configuration."><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="robots" content="index,follow"><meta property="og:title" content="Beyond Code Coverage: Supercharging Your Tests with Mutation Testing"><meta property="og:description" content="Ever wondered if your 80% test coverage actually means anything? Discover how mutation testing introduces deliberate bugs to measure your tests&#39; true effectiveness, turning your test suite from a paper tiger into a real watchdog! PITest makes this powerful technique accessible to Java developers with just a few lines of configuration."><meta property="og:type" content="article"><meta property="og:url" content="https://www.mirkosertic.de/blog/2017/02/improve-test-quality-with-mutationtesting/"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="https://www.mirkosertic.de/css/site.css" rel="stylesheet" media="screen"><link rel="shortcut icon" type="image/x-icon" href="https://www.mirkosertic.de/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://www.mirkosertic.de/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://www.mirkosertic.de/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://www.mirkosertic.de/favicon-16x16.png"><link rel="manifest" href="https://www.mirkosertic.de/manifest.json"><link rel="mask-icon" href="https://www.mirkosertic.de/safari-pinned-tab.svg" color="#5bbad5"><meta name="theme-color" content="#ffffff"><script>var _paq = window._paq = window._paq || [];
         
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="//analytics.mirkosertic.de/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '2']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();</script></head><body itemscope itemtype="http://schema.org/WebPage"><header><nav class="navbar navbar-expand-md navbar-dark fixed-top" itemscope itemtype="http://www.schema.org/SiteNavigationElement"><div class="container"><a class="navbar-brand" href="https://www.mirkosertic.de/">www.mirkosertic.de</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav mr-auto"><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/toolsgoodies" title="My personal Technology Radar">Technology Radar</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/interestingbooks" title="Interesting Books">Essential Books</a></li><li class="nav-item"><a itemprop="url" class="nav-link" href="/global/favorites" title="My favorite postings">My favorite postings</a></li><li class="nav-item"><a itemprop="url" class="nav-link active" href="/post/" title="Blog">Blog</a></li></ul></div></div></nav></header><main role="main"><div itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><div class="contentbox"><h1 class="post-title" itemprop="name headline">Beyond Code Coverage: Supercharging Your Tests with Mutation Testing</h1><p class="post-date"><span class="icon"><i class="fa fa-calendar-check-o-white"></i></span><time datetime="2017-02-14" itemprop="datePublished">Tue, Feb 14, 2017</time> <span>by</span> <span itemprop="author" itemscope="" itemtype="https://schema.org/Person"><span itemprop="name"><a href="https://x.com/mirkosertic" rel="author">Mirko Sertic</a></span></span></p><p class="post-abstract" itemprop="abstract"><span>This article explores how mutation testing can significantly improve test quality by going beyond traditional code coverage metrics. It introduces PITest, a powerful Java mutation testing framework that helps developers identify weaknesses in their test suites by introducing controlled defects into the code. The article demonstrates practical examples of how mutation testing can reveal inadequate test cases despite high code coverage, and discusses strategies for integrating mutation testing into code review systems and continuous integration pipelines, while acknowledging its limitations in complex testing scenarios.</span></p><p><span class="icon"><i class="fa fa-clock-white"></i></span><span>5 Minutes reading time</span></p><p class="post-tags"><span class="tag"><span class="icon"><i class="fa fa-tags-white"></i></span><a href="/tags/junit">JUnit</a> ,<a href="/tags/testing">Testing</a></span></p></div></header><figure class="blogtitleimage"><figcaption><p>Behold the masterpiece that AI hallucinated while reading this post:</p><p class="title">"The Little Test That Could: A Tale of Finding Hidden Bugs"</p><p>(after I fed it way too many marketing blogs and memes)</p><p class="aidisclosure">Created using DALL-E 3</p></figcaption><img src="/media/welcomeimages/improve-test-quality-with-mutationtesting_selected.png" alt="AI-Generated: The Little Test That Could: A Tale of Finding Hidden Bugs" itemprop="image"></figure><article class="post-content clearfix" itemprop="articleBody"><div class="sect1"><h2 id="_a_very_common_problem">A very common problem</h2><div class="sectionbody"><div class="paragraph"><p>Unit testing is a today must have. Together with <a href="https://en.wikipedia.org/wiki/Test-driven_development">Test-driven Development</a> and Frameworks such as <a href="http://junit.org/junit4">JUnit</a> we can easily prove that our code fulfills a set of requirements and business invariants. We use metrics like &#34;Test coverage&#34; to get insight about the completeness of our tests. A very common assumption taken from a test coverage of 80 percent is that 80 percent of our code is tested and working correctly.</p></div><div class="paragraph"><p>This code coverage thinking can be a big problem. In fact, the code coverage doesn’t say anything about the quality of our tests. It just proves that 80 percent of the example above were executed by our unit tests. It doesn’t say that the 80 percent are working correctly, and it doesn’t say that the unit test is able to detect defects of any kind in our code. The most extreme example is a unit test without assertions. It may give a high test coverage, but it doesn’t test anything at all. Therefore a test coverage of 80 percent only proves for sure that 20 percent of our code is definitely not tested at all.</p></div></div></div><div class="sect1"><h2 id="_what_to_do">What to do?</h2><div class="sectionbody"><div class="paragraph"><p>Well, we need another metric to measure the effectiveness of our tests, so we know that the 80 percent test coverage is indeed able to detect any kind of defect. And here comes a technique called <a href="https://en.wikipedia.org/wiki/Mutation_testing">Mutation testing</a> to play.</p></div><div class="paragraph"><p>Mutation testing basically adds mutation(errors) to the code and checks if the unit tests fail if a mutation was inserted.</p></div><div class="paragraph"><p>This is also called fault seeding.</p></div><div class="paragraph"><p>Every detected mutation is marked as &#34;killed&#34;, all other mutations are marked as &#34;survived&#34;.</p></div><div class="paragraph"><p>The effectiveness of our tests can then be gauged as the ratio of survived and killed mutations.</p></div></div></div><div class="sect1"><h2 id="_how_to_apply_this_technique">How to apply this technique?</h2><div class="sectionbody"><div class="paragraph"><p>Prior mutation testing systems required complex setups and special language compiler. But fortunately there is a bright shining star available to the Java world. Say hello to <a href="http://pitest.org">PITest</a>!</p></div><div class="paragraph"><p>PITest is basically a Maven plugin that can easily be added to existing projects. It runs the unit tests with a configured set of mutation operations and reports the killed and survived mutations as XML reports for machine processing and fancy HTML reports fur human eyes. It can also easily be integrated with source code quality tools such as <a href="https://www.sonarqube.org">SonarQube</a>.</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.pitest&lt;/groupId&gt;
    &lt;artifactId&gt;pitest-maven&lt;/artifactId&gt;
    &lt;version&gt;1.1.9&lt;/version&gt;
&lt;/plugin&gt;</code></pre></div></div></div></div><div class="sect1"><h2 id="_a_simple_example">A simple example</h2><div class="sectionbody"><div class="paragraph"><p>Let me show you how PITest can help us to improve unit test quality.</p></div><div class="paragraph"><p>Given the following source code:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">package de.mirkosertic.pitest;

public class Customer {

    public int discountFor(int aNumberOfOrders) {
        if (aNumberOfOrders &gt; 10) {
            return 20;
        }
        return 0;
    }
}</code></pre></div></div><div class="paragraph"><p>We run the following test:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">package de.mirkosertic.pitest;

import org.junit.Test;

import static org.junit.Assert.*;

public class CustomerTest {

    @Test
    public void testDiscount() {
        Customer theCustomer = new Customer();
        assertEquals(0, theCustomer.discountFor(5));
        assertEquals(20, theCustomer.discountFor(20));
    }
}</code></pre></div></div><div class="paragraph"><p>We get a very high test coverage for this test:</p></div><div class="paragraph"><p><span class="image"><img src="/media/goodtestcoverage.png" alt="goodtestcoverage"></span></p></div><div class="paragraph"><p>Now, let us see what happens if we apply some mutation testing. We get the following report:</p></div><div class="paragraph"><p><span class="image"><img src="/media/mutationcoveragebad.png" alt="mutationcoveragebad"></span></p></div><div class="paragraph"><p>Indeed, this is bad. It seems the unit test is missing some boundary conditions. We have to improve the test as seen here:</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java">package de.mirkosertic.pitest;

import org.junit.Test;

import static org.junit.Assert.*;

public class CustomerTest {

    @Test
    public void testDiscount() {
        Customer theCustomer = new Customer();
        assertEquals(0, theCustomer.discountFor(5));
        assertEquals(0, theCustomer.discountFor(9));
        assertEquals(0, theCustomer.discountFor(10));
        assertEquals(20, theCustomer.discountFor(11));
        assertEquals(20, theCustomer.discountFor(20));
    }
}</code></pre></div></div><div class="paragraph"><p>Now, let us check with mutation testing again:</p></div><div class="paragraph"><p><span class="image"><img src="/media/mutationcoveragegood.png" alt="mutationcoveragegood"></span></p></div><div class="paragraph"><p>Ahh, this is much better. Now, we have a very good test for our code.</p></div></div></div><div class="sect1"><h2 id="_code_review_system_integration">Code review system integration</h2><div class="sectionbody"><div class="paragraph"><p>It would be very cool to integrate mutation testing as an automated quality control into our code review system. The problem might be that mutation testing is very CPU demanding, and a full mutation testing run for every single, maybe small, commit might be an overkill and slow down the review life cycle.</p></div><div class="paragraph"><p>PITest has an integrated feature for code review system integration. It can be started with a special option to analyze the changes of the last SCM commit only. Please take a look at the <code>scmMutationCoverage</code> goal in the <a href="http://pitest.org/quickstart/maven">PITest Maven Documentation</a>. This feature greatly increases review round trip time.</p></div><div class="paragraph"><p>If you want so see this feature in action, please visit <a href="https://github.com/mirkosertic/mavensonarsputnik">Maven-Sonar-Sputnik Plugin</a>. This small tool helps to integrate PITest with <a href="https://www.sonarqube.org">Sonar</a> and <a href="https://www.gerritcodereview.com">Gerrit</a>.</p></div></div></div><div class="sect1"><h2 id="_where_are_the_limitations">Where are the limitations?</h2><div class="sectionbody"><div class="paragraph"><p>Well, every tool has its limitations. PITest works fast and transparent for all kind of unit tests. When it comes to more complex test scenarios such as integration tests with in-process databases, PITest will still give results, but it might take hours to complete. So a good strategy is so run the real unit test with PITest, and try to archive a test and mutation coverage as high as we get. Then we use integration test to test complete use cases, but here the orchestration of already tested code is the focus and we test only the orchestration logic.</p></div><div class="paragraph"><p>Also, it is not good to insist on a 100 percent mutation coverage, as this misses the same point as insisting on a 100 percent test coverage. There a certain conditions(logging for instance) that are very hard to test and are highly dependent on the configuration of the underlying system(logging configuration), In such situations it would definitely make more sense to spend your time with writing more integration tests instead of trying to get the last remaining percent of the test metric.</p></div></div></div><div class="sect1"><h2 id="_conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>Mutation testing can help us to identify leakages in our tests. It gives us a simple metric that can help us to improve the quality of our unit tests. Frameworks such as PITest can easily be added to existing projects and can do things in minutes that prior system took days to complete. I really love mutation testing!</p></div></div></div><div class="metainfo"><span>&lt;&lt;Pevious posting: <a href="https://www.mirkosertic.de/blog/2017/01/why-i-switched-to-static-html-generators/">From CMS to Static: A Journey to Blazing Fast Blogging</a></span> <span>Next posting: <a href="https://www.mirkosertic.de/blog/2017/03/integration-at-ui-level-with-server-side-includes/">Taming Microservices Chaos: Smart UI Integration with Server-Side Includes</a>&gt;&gt;</span></div><p><i class="fa fa-github"></i>Git revision: <a href="https://github.com/mirkosertic/www_mirkosertic_de/commit/2e692ad1fff282e93d9fa3fdd726190d7e7afd82" target="_blank">2e692ad</a></p></article></div></main><footer><p>&copy; Mirko Sertic &middot; <a href="https://www.mirkosertic.de/global/impressum/index.html">Imprint / Impressum</a></p><address><strong itemprop="name">Mirko Sertic</strong><div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress"><div itemprop="streetAddress">Josefine-Mauser-Str. 66</div><div itemprop="postalCode">48157 Münster</div><div itemprop="addressCountry">Germany</div></div><a class="icon" target="_top" href="mailto:mirko@mirkosertic.de"><i class="fa fa-envelope-white"></i></a> <a class="icon" target="_blank" href="https://x.com/mirkosertic" itemprop="url"><i class="fa fa-x-twitter-white"></i></a> <a class="icon" target="_blank" href="https://github.com/mirkosertic" itemprop="url"><i class="fa fa-github-white"></i></a> <a class="icon" target="_blank" href="https://de.linkedin.com/in/mirko-sertic-98882397" itemprop="url"><i class="fa fa-linkedin-white"></i></a></address><p class="float-right"><a href="#">Back to top</a></p></footer><script src="https://www.mirkosertic.de/js/bootstrap-native-v4.min.js"></script><script>function existsByCSSSelector(aSelector) {
        var element = document.querySelector(aSelector);
        if (element) {
            return true;
        }
        return false;
    }

    var Loader = function () { };
    Loader.prototype = {
        require: function (scripts, callback) {
            this.loadCount = 0;
            this.totalRequired = scripts.length;
            this.callback = callback;

            for (var i=0;i<scripts.length;i++) {
                this.writeScript(scripts[i]);
            }
        },
        loaded: function (evt) {
            this.loadCount++;

            if (this.loadCount==this.totalRequired && typeof this.callback=='function') this.callback.call();
        },
        writeScript: function (src) {
            var self = this;
            var s = document.createElement('script');
            s.type = "text/javascript";
            s.async = true;
            s.src = src;
            s.addEventListener('load', function (e) { self.loaded(e); }, false);
            var head = document.getElementsByTagName('head')[0];
            head.appendChild(s);
        }
    };

    if (existsByCSSSelector("pre.highlight code") > 0) {
        var loader = new Loader();
        loader.require(["https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"], function() {

            var additionalStylesheet = document.createElement('link');
            additionalStylesheet.rel = "stylesheet";
            additionalStylesheet.type = 'text/css';
            additionalStylesheet.media = "screen";
            additionalStylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";

            var head = document.getElementsByTagName('head')[0];
            head.appendChild(additionalStylesheet);

            hljs.highlightAll();
        });
    }</script></body></html>